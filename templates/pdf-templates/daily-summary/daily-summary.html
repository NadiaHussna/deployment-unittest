<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link href="https://fonts.googleapis.com/css?family=Nunito Sans" rel="stylesheet" />
        <title>Document</title>
        <style>
            body {
                font-size: 8px;
                letter-spacing: -0.33px;
            }
            .header {
                padding: 0px;
                border-spacing: 0;
                display: flex;
            }
            .row {
                padding: 0px;
                border-spacing: 0;
                display: flex;
                border: 0.5px solid #f4f6f4;
            }
            .table_header {
                background: #333333;
                color: #ffff;
                display: flex;
                justify-content: center;
                align-items: center;
                font-weight: 700;
                font-size: 6px;
                width: 64px;
                line-height: 1rem;
                /* box-shadow: inset -1px 0px 0px #000000; */
                box-shadow: inset 0.5px 0.5px #000000;
                letter-spacing: -0.33px;
                text-align: center;
            }
            .table_data {
                display: flex;
                justify-content: center;
                align-items: center;
                font-weight: 400;
                width: 64px;
                font-size: 6px;
                line-height: 1rem;
                letter-spacing: -0.33px;
                box-shadow: inset 0.5px 0.5px #f4f6f4;
            }
            .split_cell {
                background: #333333;
                color: #ffff;
                justify-content: center;
                display: flex;
                align-items: center;
                font-weight: 700;
                font-size: 6px;
                width: 38px;
                letter-spacing: -0.33px;
                line-height: 1rem;
                box-shadow: inset 0.5px 0.5px #000000;
            }
            .split_cell_data {
                justify-content: center;
                display: flex;
                align-items: center;
                font-weight: 400;
                font-size: 6px;
                width: 38px;
                line-height: 1rem;
                letter-spacing: -0.33px;
                text-transform: capitalize;
                /* box-shadow: inset -1px 0px 0px #f4f6f4; */
                box-shadow: inset 0.5px 0.5px #f4f6f4;
            }
        </style>
    </head>
    <body style="width: 100%; margin: 0px; font-family: Nunito Sans">
        <div style="margin: 0px 1.5rem">
            <div style="display: flex; margin-top: 2rem; align-items: flex-end">
                <div style="display: flex; flex-direction: column">
                    <div style="font-size: 0.875rem; line-height: 1.5rem; font-weight: 700; text-align: left; display: flex; flex-direction: row;">
                      <div id="ut"></div>  
                      <div>&nbsp; BOOKING TRANSACTION</div>
                        
                    </div>
                    <div style="font-size: 0.625rem; line-height: 1rem; font-weight: 400; text-align: left">
                        Kenanga Investors Berhad Daily Collection Confirmation Report For Initial Investment /
                        Additional Investment (Top-up)
                    </div>
                </div>
                <div style="flex-grow: 1"></div>
                <!-- Branch Name and TimeStamp -->
                <div>
                    <div style="font-size: 0.625rem; line-height: 1rem; font-weight: 700; float: right; display: flex">
                        <div style="font-weight: 400; text-align: right">Branch:&nbsp;</div>
                        <div id="branch-name"></div>
                    </div>
                    <div
                        id="time"
                        style="font-size: 0.625rem; font-weight: 700; line-height: 1rem; text-align: right"
                    ></div>
                </div>
                <!-- Script for Branch and TimeStamp -->
                <script>
                    const section1 = {{{json section}}}
                    document.getElementById("ut").innerHTML=section1.type
                    var timeDiv = document.getElementById('time');
                    var branchDiv = document.getElementById('branch-name');
                    var time = document.createTextNode(`${section1.time}`);
                    var branchName = document.createTextNode(`${section1.branchName}`);
                    timeDiv.appendChild(time);
                    branchDiv.appendChild(branchName);
                </script>
            </div>
            <!-- Section E-SUB -->
            <div style="display: flex; flex-direction: column;">
                <div
                    style="
                        font-size: 0.875rem;
                        font-weight: 700;
                        margin: 1rem 0px;
                        line-height: 1.5rem;
                        display: flex;
                        flex-direction: row;
                    "
                >
                    E-SUBMISSION
                </div>
                <div style="margin-top: 0.5rem">
                    <div class="header">
                        <div class="table_header" style="border-left: none; width: 25px">No.</div>
                        <div class="table_header">Remittance No. (e-Sub No.)</div>
                        <div class="table_header">OMNI Ref. No.</div>
                        <div class="table_header">Payment Method / Ref. No.</div>
                        <div class="table_header" style="width: 98px">Fund Name</div>
                        <div class="table_header">Gross Amount</div>
                        <div class="table_header">Investor Name</div>
                        <div class="table_header">Adviser Code</div>
                        <div style="display: flex; max-width: 190px; width: 190px; flex-direction: column">
                            <div
                                style="
                                    line-height: 1rem;
                                    background: #333333;
                                    color: #ffff;
                                    justify-content: center;
                                    display: flex;
                                    align-items: center;
                                    font-weight: 700;
                                    font-size: 6px;
                                    padding: 0px 8px;
                                    letter-spacing: -0.33px;
                                    border-left: 0.5px solid #000000;
                                    box-shadow: inset 0px -1px 0px #000000;
                                "
                            >
                                FORM (S)
                            </div>
                            <div style="display: flex; width: 190px">
                                <div class="split_cell">AOF</div>
                                <div class="split_cell" style="line-height: 7px">3rd Party AOF</div>
                                <div class="split_cell">9N</div>
                                <div class="split_cell">DDA</div>
                                <div class="split_cell">IC</div>
                            </div>
                        </div>
                        <div class="table_header">Remarks</div>
                    </div>
                </div>
                <!-- Section E-Submission Script -->
                <div id = 'e-sub-table' style="width: 100%; max-width: 755px;"/>
                    <script>
                      const section2 = {{{json section}}}
                        var table = document.getElementById('e-sub-table');
                        section2.submissions.map((item, index) => {
                            var row = document.createElement('div');
                            row.className = 'row';
                            
                            const tempDiv = document.createElement('div')
                            tempDiv.style= 'display:flex;width:100%';
                            
                            for (let [key] of Object.entries(item)){
                                
                                var tableData = document.createElement('div');
                                tableData.className = 'table_data';
                                tableData.style = 'text-transform:capitalize';
                                switch(key){
                                    case 'No': var data = document.createTextNode(`${item[key]}`)
                                               tableData.style="width:25px;";
                                               tableData.appendChild(data);
                                               tempDiv.appendChild(tableData);
                                               row.appendChild(tempDiv)
                                               break;
                                    case 'Fund Name':var data = item[key]
                                               tableData.style="width:98px;";
                                               if (data === 'AMP 2 Ei') tableData.innerHTML = `AMP 2 E <i>i</i>`
                                               else tableData.innerHTML = data
                                               tempDiv.appendChild(tableData);
                                               row.appendChild(tempDiv)
                                               break;
                                    case 'FORM (S)':var formDiv=document.createElement('div');
                                                formDiv.style="display: flex; width: 190px";                                                                                         
                                                for(let [key,value] of Object.entries(item['FORM (S)'])){
                                                    var splitCellData=document.createElement('div');
                                                    splitCellData.className="split_cell_data"  
                                                    var data = document.createTextNode(`${value}`)
                                                    splitCellData.appendChild(data);
                                                    formDiv.appendChild(splitCellData)}
                                                tempDiv.appendChild(formDiv);
                                                row.appendChild(tempDiv);
                                                break;
                                  
                                    default: var data = document.createTextNode(`${item[key]}`)
                                        tableData.appendChild(data);
                                        tempDiv.appendChild(tableData)
                                        row.appendChild(tempDiv)
                                        break;
                                }
                                
                            }
                            table.appendChild(row)                                
                        });
                    </script>           

            <div style="display: flex; margin-top: 64px">
                <!-- Prepared By Section -->
                <div
                    style="
                        display: flex;
                        flex-direction: column;
                        border-top: 0.5px solid;
                        text-align: left;
                        line-height: 16px;
                        font-weight: 400;
                        width: 157px;
                    "
                >
                    <div>Prepared By:</div>
                    <div style="display: flex">
                        Name:&nbsp;
                        <div style="font-weight: 700" id="prepared-by-name"></div>
                    </div>
                    <div style="display: flex">
                        Department:&nbsp;
                        <div style="font-weight: 700"id="prepared-by-department"></div>
                    </div>
                    <div style="display: flex">
                        Branch:&nbsp;
                        <div style="font-weight: 700"id="prepared-by-branch"></div>
                    </div>
                </div>
                <!-- Script for Prepared by section -->
                <script>
                   const section4 = {{{json section}}}
                    var preparedByDiv = document.getElementById('prepared-by-name');
                    var departmentDiv = document.getElementById('prepared-by-department');
                    var branchDiv = document.getElementById('prepared-by-branch');
                    var preparedBy = document.createTextNode(`${section4.preparedBy.name}`);
                    var department = document.createTextNode(`${section4.preparedBy.department}`);
                    var branch = document.createTextNode(`${section4.preparedBy.branch}`);                    
                    preparedByDiv.appendChild(preparedBy);
                    branchDiv.appendChild(branch);
                    departmentDiv.appendChild(department);
                </script>
                <div style="flex-grow: 1"></div>
                <div style="display: flex; flex-direction: column">
                    <div
                        style="
                            display: flex;
                            flex-direction: column;
                            border-top: 0.5px solid;
                            text-align: left;
                            line-height: 16px;
                            font-weight: 400;
                            width: 157px;
                        "
                    >
                        Received By (Operations):
                    </div>
                </div>
                <div style="flex-grow: 1"></div>
                <div style="display: flex; flex-direction: column">
                    <div
                        style="
                            display: flex;
                            flex-direction: column;
                            border-top: 0.5px solid;
                            text-align: left;
                            line-height: 16px;
                            font-weight: 400;
                            width: 157px;
                        "
                    >
                        Confirmed Data Entry By (Operations):
                    </div>
                </div>
               
            </div>
        </div>
        <div style="float: right; margin-top: 2rem"id="pagination"></div>
        <script>
            const section5 = {{{json section}}}
                    var paginationDiv = document.getElementById('pagination');
                    var pages = document.createTextNode(`Page ${section5.page} of ${section5.pages}`);                  
                    paginationDiv.appendChild(pages);
        </script>
    </body>
</html>
